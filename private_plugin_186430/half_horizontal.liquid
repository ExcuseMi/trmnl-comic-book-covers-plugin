{% if comics_count == 0 %}
<div class="layout layout--center">
  <div class="title text--center">No Comics Found</div>
  <div class="description text--center">
    No comic covers found with your current filters. Try adjusting your filters or check your API key.
  </div>
</div>

{% else %}

<div class="layout">
  {% if comics_count > 0 %}
  {% comment %} Full Details Mode - Single Comic with Info Panel {% endcomment %}
  {% assign comic = comics[0] %}
  {% assign name = comic.name | default: "" %}
  {% assign cover_date = comic.cover_date | default: "" %}
  {% assign issue_number = comic.issue_number | default: "" %}
  {% assign volume_name = comic.volume.name | default: "" %}
  {% assign image_url = comic.image.small_url | default: comic.image.original_url | default: "" %}
  {% assign api_detail_url = comic.api_detail_url | default: "" %}

  {% comment %} Background Image {% endcomment %}
  {% assign background_url = comic.image.screen_url | default: comic.image.medium_url | default: "" %}
  {% if background_url != "" %}
  <img src="{{ background_url }}" class="image-dither" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; object-position: center; opacity: 0.15; filter: blur(20px) brightness(1.5); z-index: 0;" />
  {% endif %}

  {% comment %} Build Comic Vine URL {% endcomment %}
  {% if api_detail_url != "" %}
  {% assign url_parts = api_detail_url | split: "/" %}
  {% assign issue_id = url_parts[5] | default: "" %}

  {% if issue_id != "" %}
  {% assign comic_vine_url = "https://comicvine.gamespot.com/issues/" | append: issue_id %}
  {% else %}
  {% assign comic_vine_url = comic.site_detail_url | default: "https://comicvine.gamespot.com/" %}
  {% endif %}
  {% else %}
  {% assign comic_vine_url = comic.site_detail_url | default: "https://comicvine.gamespot.com/" %}
  {% endif %}

  {% comment %} Format date {% endcomment %}
  {% if cover_date != "" %}
  {% assign date_parts = cover_date | split: "-" %}
  {% assign year = date_parts[0] %}
  {% assign formatted_date = year %}
  {% else %}
  {% assign formatted_date = "Unknown Date" %}
  {% endif %}

  {% comment %} Get additional details {% endcomment %}
  {% assign description = comic.description | default: "" %}

  {% assign character_names = "" | split: "" %}
  {% if comic.character_credits %}
  {% for character in comic.character_credits %}
  {% if character.name %}
  {% assign character_names = character_names | push: character.name %}
  {% endif %}
  {% endfor %}
  {% endif %}

  {% assign team_names = "" | split: "" %}
  {% if comic.team_credits %}
  {% for team in comic.team_credits %}
  {% if team.name %}
  {% assign team_names = team_names | push: team.name %}
  {% endif %}
  {% endfor %}
  {% endif %}

  {% assign people_names = "" | split: "" %}
  {% if comic.person_credits %}
  {% for person in comic.person_credits %}
  {% if person.name %}
  {% assign people_names = people_names | push: person.name %}
  {% endif %}
  {% endfor %}
  {% endif %}

  {% if description != "" %}
  {% assign description = description | strip_html | truncate: 200 %}
  {% endif %}
  <div class="flex gap--m" style="height: 100%; position: relative; z-index: 1;">
    <!-- Cover Image -->
    <div class="flex--grow-1" style="display: flex; align-items: center; justify-content: center; min-height: 0; max-height: 60vh;"> 
      <img src="{{ image_url }}" class="image image-dither image--contain" style="max-width: 70%; max-height: 100%; height: auto; border: 3px solid #000; object-fit: contain;" />
    </div>
    <!-- Details Panel -->
    <div class="flex--grow-1" style="display: flex; align-items: center; min-height: 0;">
      <div style="width: 100%;">
        <div class="title text--large mb--s clamp clamp--2">{{ name }}</div>
        <div class="description text--small mb--xs">{{ volume_name }}</div>
        <div class="flex gap--xs mb--m">
          {% if issue_number != "" %}
          <span class="label label--outlined">#{{ issue_number }}</span>
          {% endif %}
          <span class="label">{{ formatted_date }}</span>
        </div>

        <!-- QR Code -->
        {% if show_qr_code and show_qr_code != "hide" %}
        <div class="mb--m pb--m border--b">
          {{ comic_vine_url | qr_code: 2, 's' }}
        </div>
        {% endif %}

        <div class="mb--m pb--m border--b">
          <div class="label text--xs text--upper mb--xs">Synopsis</div>
          <div class="description text--xs">
            {% if description != "" %}
              {{ description }}
            {% else %}
              No synopsis available.
            {% endif %}
          </div>
        </div>

        <!-- Characters -->
        {% if character_names.size > 0 %}
        <div class="mb--m pb--m border--b">
          <div class="label text--xs text--upper mb--xs">Characters</div>
          <div class="flex flex--wrap gap--xs">
            {% for character in character_names limit: 8 %}
            <span class="label label--outlined text--xs px--s py--xs">{{ character }}</span>
            {% endfor %}
            {% if character_names.size > 8 %}
            <span class="label label--inverted text--xs px--s py--xs">+{{ character_names.size | minus: 8 }}</span>
            {% endif %}
          </div>
        </div>
        {% endif %}

        <!-- Teams -->
        {% if team_names.size > 0 %}
        <div class="mb--m pb--m border--b">
          <div class="label text--xs text--upper mb--xs">Teams</div>
          <div class="flex flex--wrap gap--xs">
            {% for team in team_names limit: 4 %}
            <span class="label label--outlined text--xs px--s py--xs">{{ team }}</span>
            {% endfor %}
          </div>
        </div>
        {% endif %}

        <!-- Creators -->
        {% if people_names.size > 0 %}
        <div class="mb--s">
          <div class="label text--xs text--upper mb--xs">Creators</div>
          <div class="flex flex--wrap gap--xs">
            {% for person in people_names limit: 6 %}
            <span class="label label--outlined text--xs px--s py--xs">{{ person }}</span>
            {% endfor %}
            {% if people_names.size > 6 %}
            <span class="label label--inverted text--xs px--s py--xs">+{{ people_names.size | minus: 6 }}</span>
            {% endif %}
          </div>
        </div>
        {% endif %}
      </div>
    </div>
  </div>

  {% endif %}
</div>

{% endif %}